<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:context="http://www.springframework.org/schema/context"
       xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-2.5.xsd
       http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-2.5.xsd">

    <import resource="classpath:com/baidu/rigel/service/workflow/api/applicationContext-test-pgsupport.xml" />

    <bean id="processEngineConfiguration" class="com.baidu.rigel.service.workflow.api.activiti.Spring25ProcessConfigurationFactory" depends-on="internalProcessEngineConfiguration">
        <property name="processEngineConfiguration">
        	<ref local="internalProcessEngineConfiguration"/>
        </property>
        <property name="processEngineName" value="dtc" />
    </bean>

    <bean id="internalProcessEngineConfiguration" class="org.activiti.engine.impl.cfg.StandaloneInMemProcessEngineConfiguration">

        <property name="jdbcUrl" value="jdbc:h2:mem:activiti;DB_CLOSE_DELAY=1000;MVCC=TRUE" />
        <property name="jdbcDriver" value="org.h2.Driver" />
        <property name="jdbcUsername" value="sa" />
        <property name="jdbcPassword" value="" />
        <property name="jdbcMaxActiveConnections" value="2" />
        <property name="jdbcMaxIdleConnections" value="2" />

        <!-- Database configurations -->
        <property name="databaseSchemaUpdate" value="true" />

        <!-- job executor configurations -->
        <property name="jobExecutorActivate" value="false" />

        <!-- mail server configurations -->
        <property name="mailServerPort" value="5025" />

        <!-- Rill extension -->
        <property name="postParseListeners">
            <bean class="com.baidu.rigel.service.workflow.api.activiti.RetrieveNextTasksHelper">
                <property name="serializeVarPermission">
                    <value>false</value>
                </property>
                <property name="transitionTakeEventListener">
                    <list>
                        <ref bean="rigelWfTransitionTraceListener" />
                    </list>
                </property>
            </bean>
        </property>

        <property name="processEngineName" value="dtc" />
    </bean>

</beans>